FROM ubuntu:22.04
WORKDIR /build

# Copy everything and show what's available
COPY . .

# List all files for debugging
RUN echo "=== ROOT DIRECTORY ===" && ls -la
RUN echo "=== CORE DIRECTORY ===" && ls -la core/ || echo "core/ not found"
RUN echo "=== CORE/QNET-CORE ===" && ls -la core/qnet-core/ || echo "core/qnet-core/ not found"
RUN echo "=== CARGO.TOML ===" && cat Cargo.toml || echo "Cargo.toml not found"

# Try to run cargo metadata to see what error occurs
RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*
RUN curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
ENV PATH="/root/.cargo/bin:$PATH"
RUN cargo --version || echo "cargo not found"
RUN cargo metadata --format-version 1 || echo "cargo metadata failed" 