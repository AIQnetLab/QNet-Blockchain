/*! QRious v4.0.2 | (C) 2017 Alasdair Mercer | GPL v3 License */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.QRious=e()}(this,function(){"use strict";function t(t,e){var n;return"function"==typeof Object.create?n=Object.create(t):(s.prototype=t,n=new s,s.prototype=null),e&&i(!0,n,e),n}function e(e,n,s,r){var o=this;return"string"!=typeof e&&(r=s,s=n,n=e,e=null),r||(r={}),e||(e=r.element||r.el||null),o.element=e,o.size=r.size||100,o.value=r.value||0,o.level=r.level||"L",o.background=r.background||"white",o.foreground=r.foreground||"black",o.padding=null==r.padding?null:r.padding,o.canvas=n||new a,o.canvas.qrious=o,o.update(),o}function i(t,e,i){for(var n in i)i.hasOwnProperty(n)&&(t&&"object"==typeof i[n]?e[n]=o(e[n],i[n]):e[n]=i[n]);return e}function n(t,e,i,n,s){var r=s-n,o=Math.abs(i-e);t.moveTo(e,i);for(var h=0;o>h;h++){var a=Math.floor((h+1)*r/o)+n;t[h%2?"lineTo":"moveTo"](++e,a)}t.lineTo(e,s)}function s(){}function r(e){var i=t(r.prototype);return i.canvas=e,i}function o(e,n){return"object"==typeof e&&null!==e?t(e,n):n}function h(){return this.size}function a(){var e=t(a.prototype);return e._element=null,e._image=null,e}var f=function(){function t(t,e,i,n){var s,r,o=i.length;for(s=0;o>s;s+=1)r=i[s]*n+e,t[r>>>3]|=1<<(7-r%8)}function e(t,e,i){var n,s,r=t.length+1,o=e<<1,h=new Array(o+r);for(h[0]=r/e|0,n=0;r>n;n+=1)s=t.charCodeAt(n),h[n+1]=128>s?s:2048>s?192|s>>>6:224|s>>>12,2048>s?h[++n+1]=128|63&s:h[++n+1]=128|s>>>6&63,2048>s||(h[++n+1]=128|63&s);for(n=r;o>n;n+=1)h[n+1]=0;return h}function i(t,e){var i,n,s,r,o,h,a,f,l,u,c,g,d,p,v,m,w,y,M,b,k,x,A,B,S,z,P,E,T,O,C,_,L=e.value.length,R=t.typeNumber,N=4*R+17,I=n.getErrorCorrectPolynomial(e.errorCorrectLevel),U=new Array(N*N);for(i=0;N>i;i+=1)for(n=0;N>n;n+=1)U[i*N+n]=null;for(i=0;R>i;i+=1)for(s=i?4*(i+1)+4:4,n=0;R>n;n+=1)for(r=n?4*(n+1)+4:4,o=s;s+4>o;o+=1)for(h=r;r+4>h;h+=1)U[o*N+h]=!0;for(i=9;N>i;i+=1)U[6*N+i]=U[i*N+6]=!0;for(i=0;7>i;i+=1)for(n=0;3>n;n+=1)U[(N-7+n)*N+(N-7+i)]=U[(N-7+i)*N+(N-7+n)]=!0;for(a=n.getBCHTypeNumber(R),i=0;18>i;i+=1)f=!t.isDark(Math.floor(i/3),i%3+N-8-3),U[i*N+8]=U[8*N+N-15+i]=f;for(i=0;15>i;i+=1)f=!t.isDark(i%3+1,Math.floor(i/3)+1),6>i?U[i*N+8]=f:8>i?U[(i+1)*N+8]=f:U[(N-15+i)*N+8]=f,8>i?U[8*N+N-i-1]=f:9>i?U[8*N+15-i-1+1]=f:U[8*N+15-i-1]=f;for(U[(N-8)*N+8]=!t.isDark(0,0),l=0,u=e.value,c=0;L>c;c+=1)for(g=u[c],d=g.mode<<4|g.getLength(),p=0;8>p;p+=1)U[l>>>3]|=(d>>>7-p%8&1)<<(7-l%8),l+=1;for(v=g.getData(),m=0;v.length>m;m+=1)for(w=v[m],p=0;8>p;p+=1)U[l>>>3]|=(w>>>7-p%8&1)<<(7-l%8),l+=1;for(y=N*N-l,M=0;4>M&&y>M;M+=1)U[l>>>3]|=0<<(7-l%8),l+=1;for(;0!=(7&l);)U[l>>>3]|=0<<(7-l%8),l+=1;for(b=Math.floor(l/8),k=I.getLength()-1,x=7,A=N-1,B=N-1,S=0;b>S;S+=k+1)for(z=S;k>z&&b>z;z+=1)for(P=0;8>P;P+=1){for(E=z+P*k+P%k;b>E;)for(T=!1,O=A,C=B;;){if(null==U[C*N+O]){if(U[C*N+O]=(E>>>3==z&&(E&7)>>>x&1)^T,0>--x&&(E+=1,x=7),0==O){C-=2;break}if(6==O&&(O-=1,C-=2),N-7==O&&(O=N-8,C-=2),O-=C%2?1:2,0>C){C=0,O-=2;break}}else{if(6==O&&O--,0==--O){C-=2;break}O-=C%2?0:1,0>C&&(C=0,O-=2)}}A=O,B=C}for(_=0,i=N-1;i>0;i-=2)for(6==i&&i--,n=0;N>n;n+=1)for(o=0;2>o;o+=1)null==U[n*N+(i-o)]&&(U[n*N+(i-o)]=!1,_+=1);return U}var n={};return n.getBCHTypeInfo=function(t){for(var e=t<<10;e-n.getBCHDigit(e)>=10;)e^=1335<<n.getBCHDigit(e)-10;return(t<<10|e)^21522},n.getBCHTypeNumber=function(t){for(var e=t<<12;e-n.getBCHDigit(e)>=13;)e^=7973<<n.getBCHDigit(e)-13;return t<<12|e},n.getBCHDigit=function(t){for(var e=0;0!=t;)e+=1,t>>>=1;return e},n.getErrorCorrectPolynomial=function(t){var e,i=new Array(t);for(i[0]=1,e=0;t>e;e+=1)i=n.multiply(i,[1,n.gexp(e)]);return i},n.multiply=function(t,e){var i,s,r=new Array(t.length+e.length-1);for(i=0;i<t.length;i+=1)for(s=0;s<e.length;s+=1)r[i+s]^=n.glog(n.gexp(n.glog(t[i])+n.glog(e[s])));return r},n.gexp=function(t){for(;0>t;)t+=255;for(;t>=256;)t-=255;return n.EXP_TABLE[t]},n.glog=function(t){if(1>t)throw new Error("glog("+t+")");return n.LOG_TABLE[t]},n.EXP_TABLE=new Array(256),n.LOG_TABLE=new Array(256),function(){var t,e;for(t=0;8>t;t+=1)n.EXP_TABLE[t]=1<<t;for(t=8;256>t;t+=1)n.EXP_TABLE[t]=n.EXP_TABLE[t-4]^n.EXP_TABLE[t-5]^n.EXP_TABLE[t-6]^n.EXP_TABLE[t-8];for(t=0;255>t;t+=1)n.LOG_TABLE[n.EXP_TABLE[t]]=t}(),{get:function(n){var s=t(f.prototype);return s.typeNumber=n.typeNumber,s.errorCorrectLevel=n.errorCorrectLevel,s.modules=[],s.moduleCount=0,s.dataCache=null,s.dataList=[],s.dataList=n.dataList,s.data=function(t){for(var i=0,n=0;n<t.length;n+=1){var s=t[n],r=s.mode;if(r<1||r>4)throw new Error("mode:"+r);if(s.getLength()<1)throw new Error("length:"+s.getLength());switch(r){case 1:i+=s.getLength();break;case 2:i+=9*s.getLength();break;case 3:i+=13*s.getLength();break;case 4:i+=8*s.getLength()}}return e(t,i)}(s.dataList),s.isDark=function(t,e){if(0>t||s.moduleCount<=t||0>e||s.moduleCount<=e)throw new Error(t+","+e);return s.modules[t][e]},s.moduleCount=4*s.typeNumber+17,s.make(),s},make:function(){this.modules=i(this,{value:this.data,errorCorrectLevel:this.errorCorrectLevel})}}}(),l=f,u={L:1,M:0,Q:3,H:2},c=function(){var t=function(t,e){this.totalCount=t,this.dataCount=e},e={},i=function(e,i){switch(i){case u.L:return t[4*(e-1)+0];case u.M:return t[4*(e-1)+1];case u.Q:return t[4*(e-1)+2];case u.H:return t[4*(e-1)+3]}},n=new Array(40);return n[0]=new t(0,0),n[1]=new t(26,19),n[2]=new t(44,34),n[3]=new t(70,55),n[4]=new t(100,80),n[5]=new t(134,108),n[6]=new t(172,136),n[7]=new t(196,156),n[8]=new t(242,194),n[9]=new t(292,232),n[10]=new t(346,274),n[11]=new t(404,324),n[12]=new t(466,370),n[13]=new t(532,428),n[14]=new t(581,461),n[15]=new t(655,523),n[16]=new t(733,589),n[17]=new t(815,647),n[18]=new t(901,721),n[19]=new t(991,795),n[20]=new t(1085,861),n[21]=new t(1156,932),n[22]=new t(1258,1006),n[23]=new t(1364,1094),n[24]=new t(1474,1174),n[25]=new t(1588,1276),n[26]=new t(1706,1370),n[27]=new t(1828,1468),n[28]=new t(1921,1531),n[29]=new t(2051,1631),n[30]=new t(2185,1735),n[31]=new t(2323,1843),n[32]=new t(2465,1955),n[33]=new t(2611,2071),n[34]=new t(2761,2191),n[35]=new t(2876,2306),n[36]=new t(3034,2434),n[37]=new t(3196,2566),n[38]=new t(3362,2702),n[39]=new t(3532,2812),n[40]=new t(3706,2956),e.getLength=function(){return n.length},e.getTotalCodewordsCount=function(t,e){return i(t,e).totalCount},e.getDataCodewordsCount=function(t,e){return i(t,e).dataCount},e}(),g={};g.L=u.L,g.M=u.M,g.Q=u.Q,g.H=u.H;var d=g,p=function(){var t=function(t,e){for(var i=1,n=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t.length?3:0)}(t),s=0,r=c.getLength()-1;r>=s;){var o=0,h=s,a=(r-s)/2|0;for(a+=s;a>=h;){var f=a,l=c.getDataCodewordsCount(f,e);if(n<=l){o=f;break}a=(a-1+h)/2|0}if(0==o){if(n<=c.getDataCodewordsCount(s,e)){o=s;break}o=r;break}if(n<=c.getDataCodewordsCount(o-1,e)){i=o;break}s=o}return i},e=function(e){return{get:function(){return t(e,this.errorCorrectLevel)},errorCorrectLevel:d.L}};return e}(),v=function(){var t=function(t){this.mode=1,this.data=t},e=t.prototype;return e.getLength=function(){return this.data.length},e.getData=function(){var t,e,i=this.data,n=[];for(t=0;t<i.length;t+=1)e=i.charCodeAt(t),e>0&&128>e?n.push(e):e>127&&2048>e?n.push(192|e>>6,128|63&e):n.push(224|e>>12,128|e>>6&63,128|63&e);return n},t}(),m=function(){var t=function(){},e=t.prototype;return e.draw=function(t,e){var i,n,s=this.qrious,r=s.modules,o=s.size,h=e.ctx,a=h.canvas;for(h.fillStyle=s.foreground,i=0;o>i;i++)for(n=0;o>n;n++)r[i][n]&&h.fillRect(n,i,1,1)},e.reset=function(){},e.resize=function(t,e){var i=this.qrious,n=e.ctx;n.canvas.width=t,n.canvas.height=t,n.clearRect(0,0,t,t),n.fillStyle=i.background,n.fillRect(0,0,t,t)},t}(),w=m;a.prototype.draw=function(t){var e=this.qrious,i=this.getElement(),n=this.getImage(),s=t.getContext("2d");i||(i=t),s.canvas!==i&&(s.canvas=i),n&&(n.style.display="none",n.width=0,n.height=0,n=null),i.width=e.size,i.height=e.size,s.fillStyle=e.background,s.fillRect(0,0,e.size,e.size),s.fillStyle=e.foreground,new w().draw(e,{ctx:s})},a.prototype.getElement=function(){if(!this._element){var t=document.createElement("canvas");this._element=t}return this._element},a.prototype.getImage=function(){return this._image},a.prototype.setImage=function(t){this._image=t};var y=a;return r.prototype.draw=function(t){var e=this.qrious,i=this.canvas.getContext("2d"),n=e.size;i.fillStyle=e.background,i.fillRect(0,0,n,n),i.fillStyle=e.foreground,new w().draw(e,{ctx:i})},r.prototype.getElement=function(){return this.canvas},r.prototype.getImage=function(){return null},r.prototype.setImage=function(){},e.prototype.update=function(){var t,e=this,i=e.value,n={level:e.level,size:e.size,value:i};if(i){var s=p({errorCorrectLevel:n.level}).get(),r=new v(i),o=l.get({typeNumber:s,errorCorrectLevel:n.level,dataList:[r]});e.modules=o.modules,e.moduleCount=o.moduleCount}e.canvas.draw(e)},e.Canvas=y,e});

